(()=>{"use strict";class t{constructor(){this.projects=[]}getProjects(){return this.projects}setProjects(t){this.projects=t}getProject(t){return this.projects.find((e=>e.getName()===t))}isInProjects(t){return this.projects.some((e=>e.getName()===t))}addProject(t){this.isInProjects(t.getName())||this.projects.push(t)}deleteProject(t){this.projects=this.projects.filter((e=>e.getName()!==t))}}class e{constructor(t){this.name=t,this.tasks=[]}getName(){return this.name}setName(t){this.name=t}getTasks(){return this.tasks}setTasks(t){this.tasks=t}getTask(t){return this.tasks.find((e=>e.getTitle()===t))}isInTasks(t){return this.tasks.some((e=>e.getTitle()===t))}addTask(t){this.isInTasks(t.getTitle())||this.tasks.push(t)}deleteTask(t){this.tasks=this.tasks.filter((e=>e.getTitle()!==t))}}class s{constructor(t,e,s){this.title=t,this.description=e,this.dueDate=s,this.isComplete=!1}getTitle(){return this.title}setTitle(t){this.title=t}getDescription(){return this.description}setDescription(t){this.description=t}getDueDate(){return this.dueDate}setDueDate(t){this.dueDate=t}getIsComplete(){return this.isComplete}setIsComplete(t){this.isComplete=t}}class c{static saveList(t){localStorage.setItem("list",JSON.stringify(t))}static getList(){let c=Object.assign(new t,JSON.parse(localStorage.getItem("list")));return c.setProjects(c.getProjects().map((t=>Object.assign(new e,t)))),c.getProjects().forEach((t=>t.setTasks(t.getTasks().map((t=>Object.assign(new s,t)))))),c}static addProject(t){let e=this.getList();e.addProject(t),this.saveList(e)}static deleteProject(t){let e=this.getList();e.deleteProject(t),this.saveList(e)}static setProjectName(t,e){let s=this.getList();s.getProject(t).setName(e),this.saveList(s)}static addTask(t,e){let s=this.getList();s.getProject(t).addTask(e),this.saveList(s)}static deleteTask(t,e){let s=this.getList();s.getProject(t).deleteTask(e),this.saveList(s)}static setTaskTitle(t,e,s){let c=this.getList();c.getProject(t).getTask(e).setTitle(s),this.saveList(c)}static setTaskDescription(t,e,s){let c=this.getList();c.getProject(t).getTask(e).setDescription(s),this.saveList(c)}static setTaskDueDate(t,e,s){let c=this.getList();c.getProject(t).getTask(e).setDueDate(s),this.saveList(c)}static setTaskIsComplete(t,e,s){let c=this.getList();c.getProject(t).getTask(e).setIsComplete(s),this.saveList(c)}}class n{constructor(){this.projectForm=document.createElement("form")}openForm(t){t&&(this.projectForm.name.value=t.getName()),this.projectForm.style.display="block"}closeForm(){this.projectForm.style.display="none",this.projectForm.reset()}addProjectToList(){let t=this.projectForm.name.value;if(document.contains(document.querySelector(".active-project"))){let e=r.getActiveProject();c.setProjectName(e.getName(),t)}else{let s=new e(t);c.addProject(s)}this.closeForm(),d()}createProjectForm(){this.projectForm.classList.add("project-form"),this.projectForm.setAttribute("action","''"),this.projectForm.setAttribute("method","get");const t=document.createElement("h3");t.textContent="Project details";const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("name","name"),e.setAttribute("id","name"),e.setAttribute("placeholder","project name"),e.required=!0;const s=document.createElement("button");s.setAttribute("type","submit"),s.textContent="Submit";const c=document.createElement("button");c.textContent="Cancel",c.addEventListener("click",(t=>{t.preventDefault(),this.closeForm()}));const n=document.createElement("div");return n.classList.add("form-btn-container"),n.appendChild(s),n.appendChild(c),this.projectForm.appendChild(t),this.projectForm.appendChild(e),this.projectForm.appendChild(n),this.projectForm.style.display="none",this.projectForm.addEventListener("submit",(t=>{t.preventDefault(),this.addProjectToList()})),this.projectForm}}function o(){let t=r.getActiveProject();const e=document.getElementById("content");let s;if(document.body.contains(document.querySelector(".project-container"))){if(s=document.querySelector(".project-container"),s.textContent="",document.body.contains(document.querySelector(".task-container"))){let t=document.querySelector(".task-container");e.removeChild(t)}}else s=document.createElement("div"),s.classList.add("project-container");const c=document.createElement("div");c.classList.add("project-header");const o=document.createElement("h2");o.classList.add("project-name"),o.textContent=t.getName();const i=r.getTasksRemaining();i.classList.add("tasks-remaining");const d=r.getTaskList();d.classList.add("task-list");const l=new n,m=(new a).createTaskForm(),u=document.createElement("button");u.classList.add("add-task-btn");const p=document.createElement("span");p.textContent="Add task";const h=document.createElement("img");h.src="./icons/add.svg",h.alt="plus sign",u.appendChild(h),u.appendChild(p);const k=document.createElement("div");k.classList.add("project-actions");const g=document.createElement("button");g.classList.add("edit-project-btn");const v=document.createElement("img");v.src="./icons/edit.svg",v.alt="Edit project",v.title="Edit project",g.appendChild(v);const j=document.createElement("button");j.classList.add("save-edit-btn");const y=document.createElement("img");y.src="./icons/check.svg",y.alt="Save changes",y.title="Save changes",j.appendChild(y);const C=document.createElement("button");C.classList.add("del-project-btn");const L=document.createElement("img");L.src="./icons/delete.svg",L.alt="Delete project",L.title="Delete project",C.appendChild(L);const T=document.createElement("button");T.textContent="Clear completed tasks",T.classList.add("clear-completed-btn"),u.addEventListener("click",(()=>{if(document.body.contains(document.querySelector(".project-form"))&&document.querySelectorAll(".project-form").forEach((t=>{t.style.display="none"})),document.body.contains(document.querySelector(".task-container"))){let t=document.querySelector(".task-container");e.removeChild(t)}m.style.display="block"})),g.addEventListener("click",(()=>{if(document.body.contains(document.querySelector(".task-form"))&&(document.querySelector(".task-form").style.display="none"),document.body.contains(document.querySelector(".task-container"))){let t=document.querySelector(".task-container");e.removeChild(t)}l.openForm(t)})),C.addEventListener("click",(()=>{r.deleteActiveProject()})),T.addEventListener("click",(()=>{r.clearCompletedTasks()})),c.appendChild(o),c.appendChild(i),k.appendChild(g),k.appendChild(C),k.appendChild(T),s.appendChild(c),s.appendChild(d),s.appendChild(u),s.appendChild(k),s.appendChild(m),s.appendChild(l.createProjectForm()),e.appendChild(s)}class a{constructor(){this.taskForm=document.createElement("form")}openForm(t){t&&(this.taskForm.title.value=t.getTitle(),this.taskForm.description.value=t.getDescription(),this.taskForm.dueDate.value=t.getDueDate()),this.taskForm.style.display="block"}closeForm(){this.taskForm.style.display="none",this.taskForm.reset()}addTaskToProject(){let t=this.taskForm.title.value,e=this.taskForm.description.value,n=this.taskForm.dueDate.value;if(document.body.contains(document.querySelector(".active-task"))){let s=r.getActiveTask().getTitle(),o=r.getActiveProject().getName();c.setTaskDescription(o,s,e),c.setTaskDueDate(o,s,n),c.setTaskTitle(o,s,t)}else{let o=new s(t,e,n),a=document.querySelector(".project-name").textContent;c.addTask(a,o)}this.closeForm(),o()}createTaskForm(){this.taskForm.classList.add("task-form"),this.taskForm.setAttribute("action","''"),this.taskForm.setAttribute("method","get");const t=document.createElement("h3");t.textContent="Task details";const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("name","title"),e.setAttribute("id","title"),e.setAttribute("placeholder","title"),e.required=!0;const s=document.createElement("textarea");s.setAttribute("name","description"),s.setAttribute("id","description"),s.setAttribute("placeholder","description"),s.required=!0;const c=document.createElement("input");c.setAttribute("type","date"),c.setAttribute("name","dueDate"),c.setAttribute("id","dueDate"),c.setAttribute("placeholder","yyyy/mm/dd"),c.required=!0;const n=document.createElement("button");n.setAttribute("type","submit"),n.textContent="Submit";const o=document.createElement("button");o.textContent="Cancel",o.addEventListener("click",(t=>{t.preventDefault(),this.closeForm()}));const a=document.createElement("div");return a.classList.add("form-btn-container"),a.appendChild(n),a.appendChild(o),this.taskForm.appendChild(t),this.taskForm.appendChild(e),this.taskForm.appendChild(s),this.taskForm.appendChild(c),this.taskForm.appendChild(a),this.taskForm.style.display="none",this.taskForm.addEventListener("submit",(t=>{t.preventDefault(),this.addTaskToProject()})),this.taskForm}}function i(){let t=r.getActiveTask();const e=new a,s=document.getElementById("content");let c;document.body.contains(document.querySelector(".task-container"))?(c=document.querySelector(".task-container"),c.textContent=""):(c=document.createElement("div"),c.classList.add("task-container"));const n=document.createElement("h2");n.classList.add("task-title"),n.textContent=t.getTitle();const o=document.createElement("p");o.classList.add("task-description"),o.textContent=t.getDescription();const i=document.createElement("p");i.classList.add("task-due-date"),i.textContent=t.getDueDate();const d=document.createElement("div");d.classList.add("task-actions");const l=document.createElement("input");l.setAttribute("type","checkbox"),l.classList.add("task-complete-box"),t.getIsComplete()?(n.classList.add("task-complete"),l.checked=!0):(l.checked=!1,n.classList.add("task-incomplete"));const m=document.createElement("button");m.classList.add("edit-task-btn");const u=document.createElement("img");u.src="./icons/edit.svg",u.alt="Edit task",u.title="Edit task",m.appendChild(u);const p=document.createElement("button");p.classList.add("save-edit-btn");const h=document.createElement("img");h.src="./icons/check.svg",h.alt="Save changes",h.title="Save changes",p.appendChild(h);const k=document.createElement("button");k.classList.add("del-task-btn");const g=document.createElement("img");g.src="./icons/delete.svg",g.alt="Delete task",g.title="Delete task",k.appendChild(g),l.addEventListener("change",(()=>{r.isTaskComplete()?l.checked=!0:l.checked=!1})),m.addEventListener("click",(()=>{document.body.contains(document.querySelector(".project-form"))&&document.querySelectorAll(".project-form").forEach((t=>{t.style.display="none"})),e.openForm(t)})),k.addEventListener("click",(()=>{r.deleteActiveTask()}));const v=document.createElement("div");v.classList.add("task-complete-container"),v.appendChild(l),d.appendChild(v),d.appendChild(m),d.appendChild(k),c.appendChild(n),c.appendChild(o),c.appendChild(i),c.appendChild(d),c.appendChild(e.createTaskForm()),s.appendChild(c)}class r{static getActiveTitle(){return document.querySelector(".active-task").textContent}static getActiveName(){return document.querySelector(".active-project").textContent}static getActiveTask(){return c.getList().getProject(this.getActiveName()).getTask(this.getActiveTitle())}static getActiveProject(){return c.getList().getProject(this.getActiveName())}static editActiveTask(t,e,s,n){let a=this.getActiveName();c.setTaskDescription(a,t,s),c.setTaskDueDate(a,t,n),c.setTaskTitle(a,t,e),o()}static deleteActiveTask(){c.deleteTask(this.getActiveName(),this.getActiveTitle()),o()}static deleteActiveProject(){c.deleteProject(this.getActiveName()),d()}static getProjectList(){let t=c.getList().getProjects();const e=document.createElement("div");for(let s=0;s<t.length;s++){let c=t[s];const n=document.createElement("button");n.textContent=c.getName(),n.addEventListener("click",(()=>{let t=document.querySelector(".project-form");(t.style.display="block")&&(t.style.display="none"),document.body.contains(document.querySelector(".active-project"))&&document.querySelector(".active-project").classList.remove("active-project"),n.classList.add("active-project"),o()})),e.appendChild(n)}return e}static getTaskList(){let t=this.getActiveProject().getTasks();const e=document.createElement("div");for(let s=0;s<t.length;s++){let c=t[s];const n=document.createElement("button");n.textContent=c.getTitle(),!0===c.getIsComplete()&&n.classList.add("task-complete"),n.addEventListener("click",(()=>{let t=document.querySelector(".task-form");(t.style.display="block")&&(t.style.display="none"),document.body.contains(document.querySelector(".project-form"))&&document.querySelectorAll(".project-form").forEach((t=>{t.style.display="none"})),document.body.contains(document.querySelector(".active-task"))&&document.querySelector(".active-task").classList.remove("active-task"),n.classList.add("active-task"),i()})),e.appendChild(n)}return e}static getTasksRemaining(){let t=this.getActiveProject().getTasks(),e=t.length,s=t.filter((t=>!t.getIsComplete())).length;const c=document.createElement("p");return c.textContent=0===e?"No tasks assigned":0===s?"All tasks are complete!":1===s?s+" task remaining":s+" tasks remaining",c}static updateTasksRemaining(){let t=document.querySelector(".tasks-remaining"),e=this.getTasksRemaining();t.textContent=e.textContent}static isTaskComplete(){let t=document.querySelector(".active-task"),e=document.querySelector(".task-title");return t.classList.contains("task-incomplete")?(t.classList.remove("task-incomplete"),e.classList.remove("task-incomplete"),t.classList.add("task-complete"),e.classList.add("task-complete"),c.setTaskIsComplete(this.getActiveName(),this.getActiveTitle(),!0),this.updateTasksRemaining(),!0):(t.classList.remove("task-complete"),e.classList.remove("task-complete"),t.classList.add("task-incomplete"),e.classList.add("task-incomplete"),c.setTaskIsComplete(this.getActiveName(),this.getActiveTitle(),!1),this.updateTasksRemaining(),!1)}static clearCompletedTasks(){let t=this.getActiveProject().getTasks().filter((t=>t.getIsComplete()));for(let e=0;e<t.length;e++){let s=t[e];c.deleteTask(this.getActiveName(),s.getTitle()),o()}}static validateDueDate(t){let e=new Date,s=new Date(t);return!(isNaN(s)||s<e)}}function d(){const t=document.getElementById("content");let e;if(document.body.contains(document.querySelector(".list-container"))){if(e=document.querySelector(".list-container"),e.textContent="",document.body.contains(document.querySelector(".project-container"))){let e=document.querySelector(".project-container");t.removeChild(e)}if(document.body.contains(document.querySelector(".task-container"))){let e=document.querySelector(".task-container");t.removeChild(e)}}else e=document.createElement("div"),e.classList.add("list-container");const s=document.createElement("h1");s.classList.add("list-header"),s.textContent="Projects";const c=r.getProjectList();c.classList.add("project-list");const o=(new n).createProjectForm(),a=document.createElement("button");a.classList.add("add-project-btn");const i=document.createElement("span");i.textContent="Add project";const d=document.createElement("img");d.src="./icons/add.svg",d.alt="plus sign",a.appendChild(d),a.appendChild(i),a.addEventListener("click",(()=>{if(document.body.contains(document.querySelector(".project-container"))){let e=document.querySelector(".project-container");t.removeChild(e)}if(document.body.contains(document.querySelector(".task-container"))){let e=document.querySelector(".task-container");t.removeChild(e)}o.style.display="block"})),e.appendChild(s),e.appendChild(c),e.appendChild(a),e.appendChild(o),t.appendChild(e)}d()})();